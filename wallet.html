<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ—à–µ–ª—ë–∫ - SolarGroup</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header__logo">
            <img src="SGLogo.svg" alt="SolarGroup" class="logo-image logo-desktop" onerror="this.style.display=none; this.nextElementSibling.style.display=block;">
            <img src="SGLogosmall.svg" alt="SolarGroup" class="logo-image logo-mobile" onerror="this.style.display=none; this.previousElementSibling.style.display=block;">
                    
        </div>
        <div class="header__controls">
            <div class="language-switcher">
                <button class="language-toggle" id="languageToggle">
                    <span class="flag-icon">üá∑üá∫</span>
                    <span class="lang-text">RU</span>
                    <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="language-dropdown" id="languageDropdown">
                    <div class="language-option" data-lang="ru">
                        <span class="flag-icon">üá∑üá∫</span>
                        <span class="lang-text">–†—É—Å—Å–∫–∏–π</span>
                    </div>
                    <div class="language-option" data-lang="en">
                        <span class="flag-icon">üá∫üá∏</span>
                        <span class="lang-text">English</span>
                    </div>
                </div>
            </div>
            <button class="notification-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="notification-count">2</span>
            </button>
            <div class="user-dropdown" id="userDropdown">
                <div class="user-profile">
                    <div class="user-avatar">–ö            
        </div>
                    <span class="user-name">–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω</span>
                    <svg class="dropdown-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                            
        </div>
                <div class="dropdown-menu">
                    <a href="#" class="dropdown-menu-item">
                        <span class="dropdown-menu-item-icon">üë§</span>
                        –ü—Ä–æ—Ñ–∏–ª—å
                    </a>
                    <a href="#" class="dropdown-menu-item">
                        <span class="dropdown-menu-item-icon">‚öôÔ∏è</span>
                        –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </a>
                    <a href="#" class="dropdown-menu-item">
                        <span class="dropdown-menu-item-icon">üìÑ</span>
                        –î–æ–∫—É–º–µ–Ω—Ç—ã
                    </a>
                    <div class="dropdown-menu-divider">            
        </div>
                    <a href="#" class="dropdown-menu-item" id="logoutBtn">
                        <span class="dropdown-menu-item-icon">üö™</span>
                        –í—ã–π—Ç–∏
                    </a>
                            
        </div>
                        
        </div>
                    
        </div>
    </header>

    <div class="app-layout">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="nav-item"><a href="wallet.html" class="nav-link">–ö–æ—à–µ–ª—ë–∫</a></li>
                <li class="nav-item"><a href="invest.html" class="nav-link">–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</a></li>
                <li class="nav-item"><a href="my-investments.html" class="nav-link">–ú–æ–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</a></li>
                <li class="nav-item"><a href="coupons.html" class="nav-link">–ö—É–ø–æ–Ω—ã –∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <h1>–ö–æ—à–µ–ª—ë–∫</h1>
                        
        </div>

            <!-- Account Balances -->
            <div class="account-balances">
                <div class="account-card account-summary">
                    <div class="account-summary__header">
                        <div class="account-summary__title-wrap">
                            <div class="account-summary__icon">üíº            
        </div>
                            <div>
                                <h3 class="account-summary__title">–û—Å–Ω–æ–≤–Ω–æ–π —Å—á—ë—Ç</h3>
                                <div class="account-summary__subtitle">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞            
        </div>
                                        
        </div>
                                    
        </div>
                        <span class="account-summary__badge">USD</span>
                                
        </div>
                    <div class="account-summary__amount" id="main-balance-amount">0,00 $            
        </div>
                    <div class="account-summary__controls">
                        <div>            
        </div>
                        <div class="account-summary__actions">
                            <a class="btn btn--primary" href="deposit.html">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</a>
                            <button class="btn btn--secondary" id="withdraw-main-btn" disabled>–í—ã–≤–µ—Å—Ç–∏</button>
                                    
        </div>
                                
        </div>
                            
        </div>

                <div class="account-card account-summary account-summary--partner">
                    <div class="account-summary__header">
                        <div class="account-summary__title-wrap">
                            <div class="account-summary__icon">ü§ù            
        </div>
                            <div>
                                <h3 class="account-summary__title">–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–π —Å—á—ë—Ç</h3>
                                <div class="account-summary__subtitle">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã            
        </div>
                                        
        </div>
                                    
        </div>
                        <span class="account-summary__badge account-summary__badge--success">+5%</span>
                                
        </div>
                    <div class="account-summary__amount" id="partner-balance-amount">0,00 $            
        </div>
                    <div class="account-summary__controls">
                        <div>            
        </div>
                        <div class="account-summary__actions">
                            <a class="btn btn--primary" href="deposit.html" disabled>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</a>
                            <button class="btn btn--secondary" id="withdraw-partner-btn" disabled>–í—ã–≤–µ—Å—Ç–∏</button>
                                    
        </div>
                                
        </div>
                            
        </div>
                        
        </div>

                <!-- Coupons Card -->
                <div class="account-card account-summary account-summary--coupons">
                    <div class="account-summary__header">
                        <div class="account-summary__title-wrap">
                            <div class="account-summary__icon">üé´</div>
                            <div>
                                <h3 class="account-summary__title">–ö—É–ø–æ–Ω—ã –∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã</h3>
                                <div class="account-summary__subtitle">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –∏ –±–æ–Ω—É—Å—ã</div>
                            </div>
                        </div>
                        <span class="account-summary__badge account-summary__badge--info" id="coupons-count">0</span>
                    </div>
                    <div class="account-summary__amount" id="coupons-amount">
                        <span class="coupons-total">0 –∫—É–ø–æ–Ω–æ–≤</span>
                    </div>
                    <div class="account-summary__controls">
                        <div class="coupons-preview" id="wallet-coupons">
                            <!-- Coupons will be populated by JavaScript -->
                            <div class="no-coupons-message">
                                <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É–ø–æ–Ω–æ–≤</p>
                            </div>
                        </div>
                        <div class="account-summary__actions">
                            <a class="btn btn--primary" href="coupons.html">–í—Å–µ –∫—É–ø–æ–Ω—ã</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transaction History -->
            <div class="transaction-history">
                <div class="transaction-history__header">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
                    <div class="transaction-filters">
                        <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                        <button class="filter-btn" data-filter="deposit">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è</button>
                        <button class="filter-btn" data-filter="withdrawal">–í—ã–≤–æ–¥—ã</button>
                        <button class="filter-btn" data-filter="investment">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</button>
                    </div>
                </div>
                
                <!-- Desktop Table View -->
                <div class="history-table-container desktop-view">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-tbody"></tbody>
                    </table>
                </div>
                
                <!-- Mobile Card View -->
                <div class="history-cards-container mobile-view" id="transactions-cards">
                    <!-- Transaction cards will be populated by JavaScript -->
                </div>
                
                <!-- Load More Button -->
                <div class="transaction-history__footer">
                    <button class="btn btn--secondary" id="load-more-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ</button>
                </div>
            </div>
        </main>
                
        </div>

    <!-- Modals and Notifications -->
    <div id="coupon-details-modal" class="modal">
        <div class="modal-content coupon-details-modal">
            <span class="close-modal">&times;</span>
            <div class="modal-body">
                <div class="coupon-detail-header">
                    <h2 id="detail-coupon-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É–ø–æ–Ω–∞</h2>
                    <span class="coupon-project-tag" id="detail-coupon-project">–ü—Ä–æ–µ–∫—Ç</span>
                            
        </div>
                <div class="coupon-detail-main">
                    <div class="coupon-bonus-display">
                        <span class="bonus-amount" id="detail-coupon-bonus">$25</span>
                        <span class="bonus-type">–±–æ–Ω—É—Å</span>
                                
        </div>
                    <div class="coupon-meta">
                        <div class="meta-item">
                            <span class="meta-label">–ò—Å—Ç–µ–∫–∞–µ—Ç:</span>
                            <span class="meta-value" id="detail-coupon-expiry">15 –æ–∫—Ç—è–±—Ä—è 2025</span>
                                    
        </div>
                        <div class="meta-item">
                            <span class="meta-label">–£—Å–ª–æ–≤–∏—è:</span>
                            <span class="meta-value" id="detail-coupon-conditions">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ $250</span>
                                    
        </div>
                        <div class="meta-item">
                            <span class="meta-label">–ö–æ–¥:</span>
                            <span class="meta-value coupon-code" id="detail-coupon-code">WELCOME25-ABC123</span>
                                    
        </div>
                                
        </div>
                            
        </div>
                <div class="coupon-actions">
                    <button class="btn btn--primary use-coupon-btn">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>
                    <button class="btn btn--secondary copy-code-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
                            
        </div>
                        
        </div>
                    
        </div>
                
        </div>

    <div id="activate-promo-modal" class="modal">
        <div class="modal-content promo-activation-modal">
            <span class="close-modal">&times;</span>
            <div class="modal-body">
                <h2>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</h2>
                <form class="promo-activation-form">
                    <div class="form-group">
                        <label for="promo-code">–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥:</label>
                        <input type="text" id="promo-code" class="form-control" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥">
                                
        </div>
                    <button type="submit" class="btn btn--primary">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>
                        
        </div>
                    
        </div>
                
        </div>

    <div id="success-notification" class="notification notification-success">
        <div class="notification-content">
            <span class="notification-icon">‚úì</span>
            <span class="notification-message">–ö—É–ø–æ–Ω —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω!</span>
                    
        </div>
                
        </div>

    <script src="app.js"></script>
    <script src="wallet.js"></script>
    <script src="language-switcher.js"></script>
    
    <!-- Inline coupons logic -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Setting up wallet coupons from API...');
            
            // Load coupons from API
            fetch(`/api/coupons/active/1?t=${Date.now()}`, {
                cache: 'no-cache',
                headers: {
                    'Cache-Control': 'no-cache',
                    'Pragma': 'no-cache'
                }
            })
                .then(res => {
                    console.log('Wallet API response status:', res.status);
                    if (!res.ok) {
                        throw new Error(`HTTP ${res.status}`);
                    }
                    return res.json();
                })
                .then(coupons => {
                    console.log('Wallet coupons loaded from API:', coupons.length);
                    
                    // Update coupons count
                    const couponsCount = document.getElementById('coupons-count');
                    if (couponsCount) {
                        couponsCount.textContent = coupons.length;
                        console.log('Updated wallet coupons count to:', coupons.length);
                    }
                    
                    // Update coupons total text
                    const couponsTotal = document.querySelector('.coupons-total');
                    if (couponsTotal) {
                        couponsTotal.textContent = `${coupons.length} –∫—É–ø–æ–Ω–æ–≤`;
                        console.log('Updated wallet coupons total to:', coupons.length);
                    }
                    
                    // Update coupons preview
                    const couponsContainer = document.getElementById('wallet-coupons');
                    if (couponsContainer) {
                        if (coupons.length > 0) {
                            const previewCoupons = coupons.slice(0, 3);
                            couponsContainer.innerHTML = previewCoupons.map(coupon => `
                                <div class="coupon-item">
                                    <span class="coupon-code">${coupon.code}</span>
                                    <span class="coupon-discount">${coupon.discount}%</span>
                                </div>
                            `).join('');
                            
                            if (coupons.length > 3) {
                                couponsContainer.innerHTML += `
                                    <div class="coupon-item" style="justify-content: center; color: var(--color-text-secondary);">
                                        +${coupons.length - 3} –µ—â–µ...
                                    </div>
                                `;
                            }
                        } else {
                            couponsContainer.innerHTML = `
                                <div class="no-coupons-message">
                                    <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É–ø–æ–Ω–æ–≤</p>
                                </div>
                            `;
                        }
                    }
                })
                .catch(e => {
                    console.error('Error loading wallet coupons from API:', e);
                    // Show error state
                    const couponsCount = document.getElementById('coupons-count');
                    if (couponsCount) {
                        couponsCount.textContent = '?';
                    }
                    
                    const couponsTotal = document.querySelector('.coupons-total');
                    if (couponsTotal) {
                        couponsTotal.textContent = '? –∫—É–ø–æ–Ω–æ–≤';
                    }
                    
                    const couponsContainer = document.getElementById('wallet-coupons');
                    if (couponsContainer) {
                        couponsContainer.innerHTML = `
                            <div class="no-coupons-message">
                                <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>
                            </div>
                        `;
                    }
                });
        });
    </script>
</body>
</html>